{"version":3,"sources":["../src/print.js"],"names":["define","$","Ajax","Notification","t","mconfig","SELECTOR","PAGE_HEADER","PAGE_CONTAINER","pageHeaderHeight","pageContainer","pageHeader","init","options","height","css","Math","abs","window","addEventListener","handlePrintStart","handlePrintStop","e","preventDefault","Y","UA","gecko","promises","call","methodname","args","attemptid","userid","courseid","cmid","quizid","pagetype","then","fail","err","exception"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for print event.\n *\n * @package   quiz_answersheets\n * @copyright 2019 The Open University\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/notification'], function($, Ajax, Notification) {\n\n    var t = {\n\n        /**\n         * Server side config.\n         */\n        mconfig: null,\n\n        /**\n         * CSS Selector.\n         */\n        SELECTOR: {\n            PAGE_HEADER: '.attempt-sheet-header-gecko',\n            PAGE_CONTAINER: '#page'\n        },\n\n        /**\n         * Page header height.\n         */\n        pageHeaderHeight: 0,\n\n        /**\n         * Page container.\n         */\n        pageContainer: null,\n\n        /**\n         * Page Header element\n         */\n        pageHeader: null,\n\n\n        /**\n         * Initialise function\n         * @param {object} options Options for ajax request\n         */\n        init: function(options) {\n            t.mconfig = options;\n            t.pageHeader = $(t.SELECTOR.PAGE_HEADER);\n            t.pageContainer = $(t.SELECTOR.PAGE_CONTAINER);\n            t.pageHeaderHeight = t.pageHeader.height();\n\n            // Set the correct position for page header.\n            t.pageHeader.css('top', -Math.abs(t.pageHeaderHeight));\n            // Set the space fof page header.\n            t.pageContainer.css('margin-top', t.pageHeaderHeight);\n\n            window.addEventListener('beforeprint', t.handlePrintStart);\n            window.addEventListener('afterprint', t.handlePrintStop);\n        },\n\n        /**\n         * Handle print start event.\n         *\n         * @param {Event} e\n         */\n        handlePrintStart: function(e) {\n            e.preventDefault();\n            t.pageContainer.css('margin-top', 0);\n            if (Y.UA.gecko) {\n                t.pageContainer.css('padding-top', t.pageHeaderHeight + 30);\n                t.pageHeader.css('top', 0);\n            }\n\n            var promises = Ajax.call([{\n                methodname: 'quiz_answersheets_create_event',\n                args: {\n                    attemptid: t.mconfig.attemptid,\n                    userid: t.mconfig.userid,\n                    courseid: t.mconfig.courseid,\n                    cmid: t.mconfig.cmid,\n                    quizid: t.mconfig.quizid,\n                    pagetype: t.mconfig.pagetype\n                }\n            }]);\n            // Handle promise.\n            promises[0].then(function() {\n                return true;\n            }).fail(function(err) {\n                Notification.exception(err);\n            });\n        },\n\n        /**\n         * Handle print stop event.\n         *\n         * @param {Event} e\n         * @returns {boolean}\n         */\n        handlePrintStop: function(e) {\n            e.preventDefault();\n            t.pageContainer.css('margin-top', t.pageHeaderHeight);\n            if (Y.UA.gecko) {\n                t.pageContainer.css('padding-top', 0);\n                t.pageHeader.css('top', -Math.abs(t.pageHeaderHeight));\n            }\n            return true;\n        }\n\n    };\n\n    return t;\n});\n"],"file":"print.min.js"}